{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ScanConfig",
  "description": "Configuration schema for a single scan job.",
  "type": "object",
  "properties": {
    "target": {
      "type": "string",
      "description": "Target to scan. Should be an absolute URI (http/https) or host/IP.",
      "oneOf": [
        { "format": "uri" },
        { "type": "string", "pattern": "^[a-zA-Z0-9\\-\\.]+(:[0-9]{1,5})?$" }
      ]
    },
    "scan_type": {
      "type": "string",
      "description": "Type of scan to run",
      "enum": ["active", "passive", "mixed"]
    },
    "modules": {
      "type": "array",
      "description": "List of module names to enable (e.g. xss, sqli, csrf, open_redirect).",
      "items": { "type": "string", "minLength": 1 },
      "uniqueItems": true,
      "default": []
    },
    "options": {
      "type": "object",
      "description": "Optional scanner options",
      "properties": {
        "timeout": { "type": "integer", "minimum": 1, "default": 10 },
        "retries": { "type": "integer", "minimum": 0, "default": 2 },
        "concurrency": { "type": "integer", "minimum": 1, "maximum": 100, "default": 5 },
        "follow_redirects": { "type": "boolean", "default": true },
        "max_depth": { "type": "integer", "minimum": 0, "default": 3 },
        "rate_limit_per_second": { "type": "number", "minimum": 0, "default": 0 }
      },
      "additionalProperties": false
    },
    "auth": {
      "type": "object",
      "description": "Authentication info for authenticated scans.",
      "properties": {
        "type": { "type": "string", "enum": ["none", "basic", "form", "token", "oauth2"], "default": "none" },
        "username": { "type": "string" },
        "password": { "type": "string" },
        "token": { "type": "string" },
        "login_path": { "type": "string" },
        "csrf_field": { "type": "string" },
        "cookie_name": { "type": "string" },
        "oauth": {
          "type": "object",
          "properties": {
            "provider": { "type": "string" },
            "client_id": { "type": "string" },
            "redirect_uri": { "type": "string" },
            "scopes": { "type": "array", "items": { "type": "string" }, "default": [] }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "schedule": {
      "type": "object",
      "description": "Optional scheduler configuration for recurring scans",
      "properties": {
        "enabled": { "type": "boolean", "default": false },
        "cron": { "type": "string" }
      },
      "additionalProperties": false
    },
    "metadata": { "type": "object", "description": "Free-form metadata", "additionalProperties": true }
  },
  "required": ["target", "scan_type"],
  "additionalProperties": false
}
